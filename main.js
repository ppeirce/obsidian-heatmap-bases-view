/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var V=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var De=Object.getOwnPropertyNames;var we=Object.prototype.hasOwnProperty;var Ce=(o,r)=>{for(var t in r)V(o,t,{get:r[t],enumerable:!0})},xe=(o,r,t,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of De(r))!we.call(o,n)&&n!==t&&V(o,n,{get:()=>r[n],enumerable:!(e=Se(r,n))||e.enumerable});return o};var ve=o=>xe(V({},"__esModule",{value:!0}),o);var Be={};Ce(Be,{default:()=>T});module.exports=ve(Be);var y=require("obsidian");var de=require("obsidian");var g=require("obsidian");var Ee=/^(\d{4})-(\d{2})-(\d{2})$/,G=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(o){let r=Ee.exec(o.trim());if(!r)return null;let t=Number(r[1]),e=Number(r[2])-1,n=Number(r[3]);if(isNaN(t)||isNaN(e)||isNaN(n))return null;let a=new Date(t,e,n);return a.setHours(0,0,0,0),a}var Le=[/^(\d{4}-\d{2}-\d{2})/,/^(\d{4})\/(\d{2})\/(\d{2})/,/^(\w+ \d{1,2}, \d{4})/];function q(o){let r=o.replace(/\.md$/i,"");for(let t of Le){let e=r.match(t);if(e){let n;e.length===4?n=`${e[1]}-${e[2]}-${e[3]}`:n=e[1];let a=S(n);if(a)return a;let s=new Date(n);if(!isNaN(s.getTime()))return s.setHours(0,0,0,0),s}}return null}function E(o){let r=o.getFullYear(),t=String(o.getMonth()+1).padStart(2,"0"),e=String(o.getDate()).padStart(2,"0");return`${r}-${t}-${e}`}function N(o){var t;let r=(t=S(o))!=null?t:new Date(o);return isNaN(r.getTime())?o:r.toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"short",day:"numeric"})}function Z(o,r){let t=[],e=new Date(o);e.setHours(0,0,0,0);let n=new Date(r);for(n.setHours(0,0,0,0);e<=n;)t.push(E(e)),e.setDate(e.getDate()+1);return t}function I(o,r){let t=o.getDay();return r===0?t:t===0?6:t-1}function x(o,r,t){let e=new Date(o);e.setHours(0,0,0,0);let n=new Date(r);n.setHours(0,0,0,0);let a=e.getTime()-n.getTime(),s=Math.floor(a/(1e3*60*60*24)),c=I(n,t);return Math.floor((s+c)/7)+1}function Q(o,r,t){var a,s;let e,n;if(t?(n=(a=S(t))!=null?a:new Date(t),isNaN(n.getTime())&&(n=new Date)):n=new Date,n.setHours(0,0,0,0),r)e=(s=S(r))!=null?s:new Date(r),isNaN(e.getTime())&&(e=new Date(n.getFullYear(),0,1));else{let c=Array.from(o.keys()).map(m=>{var i;return(i=S(m))!=null?i:new Date(m)}).filter(m=>!isNaN(m.getTime())).sort((m,i)=>m.getTime()-i.getTime());c.length>0?e=c[0]:e=new Date(n.getFullYear(),0,1)}return e.setHours(0,0,0,0),{start:e,end:n}}function j(o,r,t){let e=new Map,n=new Date(o);n.setHours(0,0,0,0);let a=new Date(r);for(a.setHours(0,0,0,0);n<=a;){let u=n.getMonth(),l=x(n,o,t),p=e.get(l);p||(p=new Set,e.set(l,p)),p.add(u),n.setDate(n.getDate()+1)}let s=[],c=x(a,o,t),m=-1,i=null;for(let u=1;u<=c;u++){let l=e.get(u);if(!l)continue;let p=Array.from(l).sort((h,f)=>h-f),d=p[p.length-1];d!==m&&(i&&(i.endColumn=u),i={name:G[d],startColumn:u,endColumn:c+1},s.push(i),m=d)}return i&&(i.endColumn=c+1),s}function J(o,r,t){let e=new Map,n=new Date(o);n.setHours(0,0,0,0);let a=new Date(r);for(a.setHours(0,0,0,0);n<=a;){let u=n.getMonth(),l=x(n,o,t),p=e.get(l);p||(p=new Set,e.set(l,p)),p.add(u),n.setDate(n.getDate()+1)}let s=[],c=x(a,o,t),m=-1,i=null;for(let u=1;u<=c;u++){let l=e.get(u);if(!l)continue;let p=Array.from(l).sort((h,f)=>h-f),d=p[p.length-1];d!==m&&(i&&(i.endRow=u),i={name:G[d],startRow:u,endRow:c+1},s.push(i),m=d)}return i&&(i.endRow=c+1),s}function z(o){let r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return o===1?["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]:r}function P(o){return o.includes(".")?o:`frontmatter.${o}`}function K(o,r){var n,a;if(r==="__filename__"||!r)try{let s=q(o.file.basename);return s?E(s):(console.warn(`Failed to parse date from filename: "${o.file.basename}"`,{file:o.file.path}),null)}catch(s){return console.warn(`Error parsing date from filename: "${o.file.basename}"`,{file:o.file.path,error:String(s)}),null}let t=P(r),e=o.getValue(t);if(e===null||e instanceof g.NullValue)return null;try{if(e instanceof g.DateValue){let m=e.toString(),i=(n=S(m))!=null?n:new Date(m);return isNaN(i.getTime())?(console.warn(`Invalid date in property "${r}": "${m}"`,{file:o.file.path,property:r}),null):E(i)}let s=e.toString(),c=(a=S(s))!=null?a:new Date(s);return isNaN(c.getTime())?(console.warn(`Invalid date in property "${r}": "${s}"`,{file:o.file.path,property:r}),null):E(c)}catch(s){return console.warn(`Error parsing date from property "${r}"`,{file:o.file.path,property:r,error:String(s)}),null}}function Ne(o,r){let t=P(r),e=o.getValue(t);if(e===null||e instanceof g.NullValue)return{value:null,displayValue:`${r}: not set`,type:"unsupported"};if(e instanceof g.BooleanValue){let a=e.isTruthy();return{value:a?1:0,displayValue:a?"Yes":"No",type:"boolean"}}if(e instanceof g.NumberValue){let a=Number(e.toString());return isNaN(a)?{value:null,displayValue:e.toString(),type:"unsupported"}:{value:a,displayValue:String(a),type:"number"}}if(e instanceof g.StringValue){let a=e.toString(),s=parseFloat(a);if(!isNaN(s))return{value:s,displayValue:a,type:"number"};let c=a.toLowerCase();return c==="true"||c==="yes"?{value:1,displayValue:"Yes",type:"boolean"}:c==="false"||c==="no"?{value:0,displayValue:"No",type:"boolean"}:{value:null,displayValue:a,type:"unsupported"}}return{value:e.isTruthy()?1:0,displayValue:e.toString(),type:"boolean"}}function X(o,r,t){let e=new Map,n=1/0,a=-1/0,s=0,c=!1,m=0;for(let i of o){let u=K(i,r);if(!u){m++;continue}let{value:l,displayValue:p,type:d}=Ne(i,t);d==="number"&&l!==null&&l!==0&&l!==1&&(c=!0),l!==null&&(n=Math.min(n,l),a=Math.max(a,l),s++);let h=e.get(u);h?l!==null&&(h.value===null||l>h.value)&&e.set(u,{date:u,value:l,note:i.file,displayValue:p}):e.set(u,{date:u,value:l,note:i.file,displayValue:p})}return n===1/0&&(n=0),a===-1/0&&(a=1),n===a&&n>0&&(n=0),m>0&&console.warn(`Data processing summary: ${m} entries skipped due to invalid dates.`,{totalEntries:o.length,skippedEntries:m,successfulEntries:e.size,dateProperty:r}),{entries:e,stats:{min:n,max:a,count:s,hasNumeric:c}}}function ee(o,r,t){let e=!1,n=!1,a=!1,s=P(r);for(let c of o){if(!K(c,t))continue;let i=c.getValue(s);if(!(i===null||i instanceof g.NullValue))if(a=!0,i instanceof g.BooleanValue)e=!0;else if(i instanceof g.NumberValue){let u=Number(i.toString());if(isNaN(u))return"unsupported";u!==0&&u!==1?n=!0:e=!0}else if(i instanceof g.StringValue){let u=i.toString(),l=parseFloat(u);if(!isNaN(l))l!==0&&l!==1?n=!0:e=!0;else{let p=u.toLowerCase();if(["true","false","yes","no"].includes(p))e=!0;else return"unsupported"}}else e=!0}return a?n?"number":e?"boolean":"unsupported":"unsupported"}var te={small:11,medium:16,large:24},M=[{id:"green",name:"Green",zeroColor:"#ebedf0",maxColor:"#39d353",isDefault:!0},{id:"purple",name:"Purple",zeroColor:"#ebedf0",maxColor:"#a78bfa",isDefault:!0},{id:"blue",name:"Blue",zeroColor:"#ebedf0",maxColor:"#38bdf8",isDefault:!0},{id:"orange",name:"Orange",zeroColor:"#ebedf0",maxColor:"#fb923c",isDefault:!0},{id:"gray",name:"Gray",zeroColor:"#ebedf0",maxColor:"#adbac7",isDefault:!0}],ne={showHexColorInTooltip:!1,colorSchemes:M};function A(o){let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:{r:0,g:0,b:0}}function Me(o,r,t){let e=n=>Math.max(0,Math.min(255,Math.round(n))).toString(16).padStart(2,"0");return`#${e(o)}${e(r)}${e(t)}`}function R(o){return/^#?[0-9a-f]{6}$/i.test(o)}function oe(o){return o.startsWith("#")?o:`#${o}`}function $(o){return o<=.0031308?o*12.92:1.055*Math.pow(o,1/2.4)-.055}function v(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function re(o,r,t){let e=v(o/255),n=v(r/255),a=v(t/255),s=.4122214708*e+.5363325363*n+.0514459929*a,c=.2119034982*e+.6806995451*n+.1073969566*a,m=.0883024619*e+.2817188376*n+.6299787005*a,i=Math.cbrt(s),u=Math.cbrt(c),l=Math.cbrt(m);return{L:.2104542553*i+.793617785*u-.0040720468*l,a:1.9779984951*i-2.428592205*u+.4505937099*l,b:.0259040371*i+.7827717662*u-.808675766*l}}function ke(o,r,t){let e=o+.3963377774*r+.2158037573*t,n=o-.1055613458*r-.0638541728*t,a=o-.0894841775*r-1.291485548*t,s=e*e*e,c=n*n*n,m=a*a*a,i=4.0767416621*s-3.3077115913*c+.2309699292*m,u=-1.2684380046*s+2.6097574011*c-.3413193965*m,l=-.0041960863*s-.7034186147*c+1.707614701*m;return{r:Math.round($(i)*255),g:Math.round($(u)*255),b:Math.round($(l)*255)}}function O(o,r,t){let e=A(o),n=A(r),a=re(e.r,e.g,e.b),s=re(n.r,n.g,n.b),c=a.L+(s.L-a.L)*t,m=a.a+(s.a-a.a)*t,i=a.b+(s.b-a.b)*t,u=ke(c,m,i);return Me(u.r,u.g,u.b)}function Te(o){let r=A(o),t=v(r.r/255),e=v(r.g/255),n=v(r.b/255);return .2126*t+.7152*e+.0722*n}function ae(o,r){let t=Te(o);if(r){if(t>.15)return O(o,"#161b22",.7)}else if(t<.85)return O(o,"#ebedf0",.7);return o}function He(o,r){let t=oe(o),e=oe(r);return{dark:{zero:ae(t,!0),max:e},light:{zero:ae(t,!1),max:e}}}function se(o){return He(o.zeroColor,o.maxColor)}function ie(o,r,t){return t===r?1:o<=r?0:o>=t?1:(o-r)/(t-r)}function le(o){return o?1:0}function ce(o,r,t){let e=t?r.dark:r.light;if(o<=0)return e.zero;let n=Math.max(0,Math.min(1,o));return O(e.zero,e.max,n)}function W(){return document.body.classList.contains("theme-dark")}function Ve(o,r,t){let e=r.get(o);if(!e)return{type:"empty"};if(e.value===null)return{type:"zero",note:e.note};let n;return t.hasNumeric?n=ie(e.value,t.min,t.max):n=le(e.value>0),{type:"filled",note:e.note,intensity:n}}function Ie(o,r,t,e,n,a){let s=document.createElement("div");s.className="heatmap-cell",s.dataset.date=o,s.style.gridRow=String(t),s.style.gridColumn=String(e);let c=W();r.type==="empty"?s.classList.add("heatmap-cell--empty"):r.type==="zero"?(s.classList.add("heatmap-cell--zero"),s.dataset.notePath=r.note.path):r.type==="filled"&&(s.classList.add("heatmap-cell--filled"),s.dataset.notePath=r.note.path,s.dataset.intensity=String(r.intensity),s.style.backgroundColor=ce(r.intensity,a,c)),n&&(s.dataset.displayValue=n.displayValue);let m=N(o),i=n?n.displayValue:"No note";return s.setAttribute("aria-label",`${m}: ${i}`),s}function ze(o,r){let t=document.createElement("div");t.className="heatmap-month-labels heatmap-month-labels-horizontal",t.style.setProperty("--total-weeks",String(r));for(let e of o){let n=document.createElement("span");n.className="heatmap-month-label",n.textContent=e.name,n.style.gridColumnStart=String(e.startColumn),n.style.gridColumnEnd=String(e.endColumn),t.appendChild(n)}return t}function Pe(o){let r=document.createElement("div");r.className="heatmap-weekday-labels";let t=z(o),e=o===1?[0,2,4]:[1,3,5];for(let n=0;n<7;n++){let a=document.createElement("span");a.className="heatmap-weekday-label",e.includes(n)&&(a.textContent=t[n]),r.appendChild(a)}return r}function $e(o,r){let t=document.createElement("div");t.className="heatmap-month-labels heatmap-month-labels-vertical",t.style.setProperty("--total-weeks",String(r));for(let e of o){let n=document.createElement("span");n.className="heatmap-month-label",n.textContent=e.name,n.style.gridRowStart=String(e.startRow),n.style.gridRowEnd=String(e.endRow),t.appendChild(n)}return t}function Ae(o){let r=document.createElement("div");r.className="heatmap-weekday-labels-horizontal";let t=z(o);for(let e of t){let n=document.createElement("span");n.className="heatmap-weekday-label",n.textContent=e,r.appendChild(n)}return r}function L(o,r){let t=document.createElement("div");t.className="heatmap-empty-state";let e=document.createElement("div");e.className="heatmap-empty-state-icon",e.textContent="\u26A0",t.appendChild(e);let n=document.createElement("div");n.className="heatmap-empty-state-title",n.textContent=o,t.appendChild(n);let a=document.createElement("div");return a.className="heatmap-empty-state-description",a.textContent=r,t.appendChild(a),t}function ue(o,r,t){var _;let{entries:e,stats:n}=o,{schemeDefinition:a,weekStart:s,showWeekdayLabels:c,showMonthLabels:m,layoutDirection:i,cellSize:u}=t,l=Z(r.start,r.end),p=x(r.end,r.start,s),d=document.createElement("div");d.className="heatmap-container",d.classList.add(i==="vertical"?"heatmap--vertical":"heatmap--horizontal"),d.style.setProperty("--cell-size",`${te[u]}px`),W()?d.classList.add("heatmap--dark"):d.classList.add("heatmap--light");let h=document.createElement("div");h.className="heatmap-scroll-wrapper",i==="vertical"&&h.classList.add("heatmap-scroll-wrapper--vertical");let f=document.createElement("div");f.className="heatmap-inner-wrapper",c&&i==="horizontal"&&f.classList.add("heatmap-inner-wrapper--with-labels");let D=document.createElement("div");D.className="heatmap-grid";let C=document.createElement("div");C.className="heatmap-cells",C.classList.add(i==="vertical"?"heatmap-cells--vertical":"heatmap-cells--horizontal"),C.style.setProperty("--total-weeks",String(p)),C.setAttribute("role","grid");let B=document.createDocumentFragment();for(let b of l){let w=(_=S(b))!=null?_:new Date(b);if(isNaN(w.getTime()))continue;let Y=I(w,s),U=x(w,r.start,s),he=Ve(b,e,n),fe=e.get(b),ge=i==="vertical"?U:Y+1,ye=i==="vertical"?Y+1:U,be=Ie(b,he,ge,ye,fe,a);B.appendChild(be)}if(C.appendChild(B),i==="vertical"){if(D.classList.add("heatmap-grid--vertical"),c){let w=Ae(s);m&&w.classList.add("heatmap-weekday-labels-horizontal--with-months"),D.appendChild(w)}let b=document.createElement("div");if(b.className="heatmap-grid-body",m){let w=J(r.start,r.end,s);b.appendChild($e(w,p))}b.appendChild(C),D.appendChild(b),f.appendChild(D)}else{if(m){let b=j(r.start,r.end,s);f.appendChild(ze(b,p))}c&&D.appendChild(Pe(s)),D.appendChild(C),f.appendChild(D)}return h.appendChild(f),d.appendChild(h),d}var me=require("obsidian");function pe(o){let{app:r,entries:t,containerEl:e,plugin:n,layoutDirection:a="horizontal"}=o,s=[],c=l=>{let d=l.target.closest(".heatmap-cell");if(!(d instanceof HTMLElement))return;let h=d.dataset.notePath;h&&r.workspace.openLinkText(h,"",!1)};e.addEventListener("click",c),s.push(()=>e.removeEventListener("click",c));let m=l=>{let d=l.target.closest(".heatmap-cell");if(!(d instanceof HTMLElement))return;let h=d.dataset.date;if(!h)return;let f=d.dataset.notePath;f&&(l.ctrlKey||l.metaKey)&&r.workspace.trigger("hover-link",{event:l,source:"heatmap-bases-view",hoverParent:e,targetEl:d,linktext:f,sourcePath:""});let D=Oe(h,t.get(h),d,n);(0,me.setTooltip)(d,D,{placement:"top"})};e.addEventListener("mouseover",m),s.push(()=>e.removeEventListener("mouseover",m));let i=l=>{let d=l.target.closest(".heatmap-cell");if(!(!(d instanceof HTMLElement)||!d.dataset.date)){if(l.key==="Enter"){let f=d.dataset.notePath;f&&r.workspace.openLinkText(f,"",!1)}["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(l.key)&&(l.preventDefault(),We(d,l.key,e,a))}};return e.addEventListener("keydown",i),s.push(()=>e.removeEventListener("keydown",i)),e.querySelectorAll(".heatmap-cell").forEach(l=>{l.tabIndex=0}),()=>{s.forEach(l=>l())}}function Oe(o,r,t,e){let n=N(o);if(!r)return`${n}
No note`;let a=t.dataset.displayValue||r.displayValue,s=t.style.backgroundColor?Re(t.style.backgroundColor):"",c=e.settings.showHexColorInTooltip&&s?`
${s}`:"";return`${n}
${a}${c}`}function Re(o){if(o.startsWith("#"))return o;let r=o.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(!r)return o;let t=parseInt(r[1],10),e=parseInt(r[2],10),n=parseInt(r[3],10),a=s=>s.toString(16).padStart(2,"0");return`#${a(t)}${a(e)}${a(n)}`}function We(o,r,t,e){var l;let n=o.dataset.date;if(!n)return;let a=(l=S(n))!=null?l:new Date(n);if(isNaN(a.getTime()))return;let s=0,c=e==="vertical";switch(r){case"ArrowUp":s=c?-7:-1;break;case"ArrowDown":s=c?7:1;break;case"ArrowLeft":s=c?-1:-7;break;case"ArrowRight":s=c?1:7;break;default:return}let m=new Date(a);m.setDate(a.getDate()+s);let i=Fe(m),u=t.querySelector(`.heatmap-cell[data-date="${i}"]`);u instanceof HTMLElement&&u.focus()}function Fe(o){let r=o.getFullYear(),t=String(o.getMonth()+1).padStart(2,"0"),e=String(o.getDate()).padStart(2,"0");return`${r}-${t}-${e}`}var k=class extends de.BasesView{constructor(t,e,n){super(t);this.plugin=n;this.type="heatmap";this.cleanupInteractions=null;this.processedData=null;this.containerEl=e.createDiv("heatmap-view-container")}getConfig(){let t=this.config,e=t.get("minValue"),n=t.get("maxValue"),a=e?parseFloat(e):null,s=n?parseFloat(n):null;return{dateProperty:t.get("dateProperty")||"__filename__",valueProperty:t.get("valueProperty")||"",startDate:t.get("startDate")||null,endDate:t.get("endDate")||null,colorScheme:t.get("colorScheme")||"green",weekStart:parseInt(t.get("weekStart")||"0",10),showWeekdayLabels:t.get("showWeekdayLabels")!==!1,showMonthLabels:t.get("showMonthLabels")!==!1,layoutDirection:t.get("layoutDirection")||"horizontal",cellSize:t.get("cellSize")||"small",minValue:a!==null&&!isNaN(a)?a:null,maxValue:s!==null&&!isNaN(s)?s:null}}onDataUpdated(){this.render()}render(){var l;this.cleanupInteractions&&(this.cleanupInteractions(),this.cleanupInteractions=null),this.containerEl.empty();let t=this.getConfig();if(!t.valueProperty){let p=L("Configure value property","Select a property to visualize in the view settings.");this.containerEl.appendChild(p);return}let e=this.data;if(!e)return;let n=e.data||[];if(n.length===0){let p=L("No data to display","No notes found in the current filter. Check your Base filters.");this.containerEl.appendChild(p);return}if(ee(n,t.valueProperty,t.dateProperty)==="unsupported"){let p=L("Unsupported property type",`"${t.valueProperty}" is not a boolean or number property. Heatmap requires boolean or number properties.`);this.containerEl.appendChild(p);return}if(this.processedData=X(n,t.dateProperty,t.valueProperty),t.minValue!==null&&(this.processedData.stats.min=t.minValue),t.maxValue!==null&&(this.processedData.stats.max=t.maxValue),this.processedData.entries.size===0){let p=L("No dated notes found","No notes with valid dates were found. Check your date property setting.");this.containerEl.appendChild(p);return}let s=Q(this.processedData.entries,t.startDate,t.endDate),c=(l=this.plugin.settings.colorSchemes.find(p=>p.id===t.colorScheme))!=null?l:this.plugin.settings.colorSchemes[0],i={schemeDefinition:se(c),weekStart:t.weekStart,showWeekdayLabels:t.showWeekdayLabels,showMonthLabels:t.showMonthLabels,layoutDirection:t.layoutDirection,cellSize:t.cellSize},u=ue(this.processedData,s,i);this.containerEl.appendChild(u),this.cleanupInteractions=pe({app:this.app,entries:this.processedData.entries,containerEl:u,plugin:this.plugin,layoutDirection:t.layoutDirection})}};var T=class extends y.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new F(this.app,this)),this.app.workspace.registerHoverLinkSource("heatmap-bases-view",{display:"Heatmap",defaultMod:!0}),this.registerBasesView("heatmap",{name:"Heatmap",icon:"calendar-heat",factory:(t,e)=>new k(t,e,this),options:()=>[{type:"property",key:"dateProperty",displayName:"Date property",placeholder:"Use filename for daily notes"},{type:"property",key:"valueProperty",displayName:"Value property"},{type:"text",key:"startDate",displayName:"Start date",placeholder:"YYYY-MM-DD (leave empty for auto)"},{type:"text",key:"endDate",displayName:"End date",placeholder:"YYYY-MM-DD (leave empty for today)"},{type:"dropdown",key:"colorScheme",displayName:"Color scheme",default:"green",options:this.getColorSchemeOptions()},{type:"dropdown",key:"weekStart",displayName:"Week starts on",default:"0",options:{0:"Sunday",1:"Monday"}},{type:"toggle",key:"showWeekdayLabels",displayName:"Show weekday labels",default:!0},{type:"toggle",key:"showMonthLabels",displayName:"Show month labels",default:!0},{type:"dropdown",key:"layoutDirection",displayName:"Layout direction",default:"horizontal",options:{horizontal:"Horizontal (GitHub-style)",vertical:"Vertical (calendar-style)"}},{type:"dropdown",key:"cellSize",displayName:"Cell size",default:"small",options:{small:"Small (11px)",medium:"Medium (16px)",large:"Large (24px)"}},{type:"text",key:"minValue",displayName:"Min value",placeholder:"Auto (based on data)"},{type:"text",key:"maxValue",displayName:"Max value",placeholder:"Auto (based on data)"}]})}onunload(){}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},ne,t),(!this.settings.colorSchemes||this.settings.colorSchemes.length===0)&&(this.settings.colorSchemes=M)}async saveSettings(){await this.saveData(this.settings)}getColorSchemeOptions(){let t={};for(let e of this.settings.colorSchemes)t[e.id]=e.name;return t}},F=class extends y.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),new y.Setting(t).setName("Show hex color in tooltip").setDesc("Display the hex color code in cell tooltips on hover").addToggle(e=>e.setValue(this.plugin.settings.showHexColorInTooltip).onChange(async n=>{this.plugin.settings.showHexColorInTooltip=n,await this.plugin.saveSettings()})),new y.Setting(t).setName("Color schemes").setHeading(),new y.Setting(t).setDesc("Add, edit, or remove color schemes used in heatmaps. Changes are available in the view settings.").addButton(e=>e.setButtonText("Add color scheme").setCta().onClick(()=>this.addScheme()));for(let e of this.plugin.settings.colorSchemes)this.renderSchemeRow(t,e)}renderSchemeRow(t,e){let n=new y.Setting(t).setName(e.name).setDesc(`${e.zeroColor} \u2192 ${e.maxColor}`).addButton(s=>s.setIcon("pencil").setTooltip("Edit").onClick(()=>this.editScheme(e))).addButton(s=>s.setIcon("trash").setTooltip("Delete").onClick(()=>this.deleteScheme(e))),a=n.controlEl.createDiv("heatmap-color-scheme-preview");a.setCssProps({background:`linear-gradient(to right, ${e.zeroColor}, ${e.maxColor})`}),n.controlEl.insertBefore(a,n.controlEl.firstChild)}addScheme(){let t={id:"",name:"",zeroColor:"#ebedf0",maxColor:"#39d353"};new H(this.app,t,!0,e=>{this.plugin.settings.colorSchemes.push(e),this.plugin.saveSettings().then(()=>this.display())}).open()}editScheme(t){new H(this.app,t,!1,e=>{let n=this.plugin.settings.colorSchemes.findIndex(a=>a.id===t.id);n!==-1&&(this.plugin.settings.colorSchemes[n]=e,this.plugin.saveSettings().then(()=>this.display()))}).open()}async deleteScheme(t){let e=this.plugin.settings.colorSchemes.findIndex(n=>n.id===t.id);e!==-1&&(this.plugin.settings.colorSchemes.splice(e,1),this.plugin.settings.colorSchemes.length===0&&(this.plugin.settings.colorSchemes=[...M]),await this.plugin.saveSettings(),this.display())}},H=class extends y.Modal{constructor(t,e,n,a){super(t);this.errorEl=null;this.scheme={...e},this.isNew=n,this.onSave=a}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?"Add color scheme":"Edit color scheme"}),new y.Setting(t).setName("Name").setDesc("Display name for this color scheme").addText(e=>e.setPlaceholder("My custom scheme").setValue(this.scheme.name).onChange(n=>this.scheme.name=n)),new y.Setting(t).setName("Zero color").setDesc("Color for empty/zero values (hex format, e.g. #ebedf0)").addText(e=>e.setPlaceholder("#ebedf0").setValue(this.scheme.zeroColor).onChange(n=>this.scheme.zeroColor=n)),new y.Setting(t).setName("Max color").setDesc("Color for maximum values (hex format, e.g. #39d353)").addText(e=>e.setPlaceholder("#39d353").setValue(this.scheme.maxColor).onChange(n=>this.scheme.maxColor=n)),this.errorEl=t.createDiv("heatmap-modal-error"),new y.Setting(t).addButton(e=>e.setButtonText("Save").setCta().onClick(()=>this.save())).addButton(e=>e.setButtonText("Cancel").onClick(()=>this.close()))}save(){if(!this.scheme.name.trim()){this.showError("Name is required");return}if(!R(this.scheme.zeroColor)){this.showError("Zero color must be a valid hex color (e.g. #ebedf0)");return}if(!R(this.scheme.maxColor)){this.showError("Max color must be a valid hex color (e.g. #39d353)");return}this.scheme.zeroColor.startsWith("#")||(this.scheme.zeroColor="#"+this.scheme.zeroColor),this.scheme.maxColor.startsWith("#")||(this.scheme.maxColor="#"+this.scheme.maxColor),this.isNew&&(this.scheme.id=this.scheme.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""),this.scheme.id||(this.scheme.id="scheme")),this.onSave(this.scheme),this.close()}showError(t){this.errorEl&&(this.errorEl.textContent=t)}onClose(){this.contentEl.empty()}};
