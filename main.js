/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var L=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var de=Object.getOwnPropertyNames;var he=Object.prototype.hasOwnProperty;var fe=(r,o)=>{for(var t in o)L(r,t,{get:o[t],enumerable:!0})},ge=(r,o,t,e)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of de(o))!he.call(r,n)&&n!==t&&L(r,n,{get:()=>o[n],enumerable:!(e=pe(o,n))||e.enumerable});return r};var ye=r=>ge(L({},"__esModule",{value:!0}),r);var Ve={};fe(Ve,{default:()=>T});module.exports=ye(Ve);var g=require("obsidian");var ae=require("obsidian");var f=require("obsidian");var be=/^(\d{4})-(\d{2})-(\d{2})$/;function y(r){let o=be.exec(r.trim());if(!o)return null;let t=Number(o[1]),e=Number(o[2])-1,n=Number(o[3]);if(isNaN(t)||isNaN(e)||isNaN(n))return null;let a=new Date(t,e,n);return a.setHours(0,0,0,0),a}var Se=[/^(\d{4}-\d{2}-\d{2})/,/^(\d{4})\/(\d{2})\/(\d{2})/,/^(\w+ \d{1,2}, \d{4})/];function F(r){let o=r.replace(/\.md$/i,"");for(let t of Se){let e=o.match(t);if(e){let n;e.length===4?n=`${e[1]}-${e[2]}-${e[3]}`:n=e[1];let a=y(n);if(a)return a;let s=new Date(n);if(!isNaN(s.getTime()))return s.setHours(0,0,0,0),s}}return null}function x(r){let o=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),e=String(r.getDate()).padStart(2,"0");return`${o}-${t}-${e}`}function W(r){var t;let o=(t=y(r))!=null?t:new Date(r);return isNaN(o.getTime())?r:o.toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"short",day:"numeric"})}function R(r,o){let t=[],e=new Date(r);e.setHours(0,0,0,0);let n=new Date(o);for(n.setHours(0,0,0,0);e<=n;)t.push(x(e)),e.setDate(e.getDate()+1);return t}function H(r,o){let t=r.getDay();return o===0?t:t===0?6:t-1}function w(r,o,t){let e=new Date(r);e.setHours(0,0,0,0);let n=new Date(o);n.setHours(0,0,0,0);let a=e.getTime()-n.getTime(),s=Math.floor(a/(1e3*60*60*24)),l=H(n,t);return Math.floor((s+l)/7)+1}function _(r,o,t){var a,s;let e,n;if(t?(n=(a=y(t))!=null?a:new Date(t),isNaN(n.getTime())&&(n=new Date)):n=new Date,n.setHours(0,0,0,0),o)e=(s=y(o))!=null?s:new Date(o),isNaN(e.getTime())&&(e=new Date(n.getFullYear(),0,1));else{let l=Array.from(r.keys()).map(u=>{var m;return(m=y(u))!=null?m:new Date(u)}).filter(u=>!isNaN(u.getTime())).sort((u,m)=>u.getTime()-m.getTime());l.length>0?e=l[0]:e=new Date(n.getFullYear(),0,1)}return e.setHours(0,0,0,0),{start:e,end:n}}function Y(r,o,t){let e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=new Map,a=new Date(r);a.setHours(0,0,0,0);let s=new Date(o);for(s.setHours(0,0,0,0);a<=s;){let p=a.getMonth(),c=w(a,r,t),d=n.get(c);d||(d=new Set,n.set(c,d)),d.add(p),a.setDate(a.getDate()+1)}let l=[],u=w(s,r,t),m=-1,i=null;for(let p=1;p<=u;p++){let c=n.get(p);if(!c)continue;let d=Array.from(c).sort((b,D)=>b-D),h=d[d.length-1];h!==m&&(i&&(i.endColumn=p),i={name:e[h],startColumn:p,endColumn:u+1},l.push(i),m=h)}return i&&(i.endColumn=u+1),l}function U(r){let o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return r===1?["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]:o}function I(r){return r.includes(".")?r:`frontmatter.${r}`}function q(r,o){var n,a;if(o==="__filename__"||!o)try{let s=F(r.file.basename);return s?x(s):(console.warn(`Failed to parse date from filename: "${r.file.basename}"`,{file:r.file.path}),null)}catch(s){return console.warn(`Error parsing date from filename: "${r.file.basename}"`,{file:r.file.path,error:String(s)}),null}let t=I(o),e=r.getValue(t);if(e===null||e instanceof f.NullValue)return null;try{if(e instanceof f.DateValue){let u=e.toString(),m=(n=y(u))!=null?n:new Date(u);return isNaN(m.getTime())?(console.warn(`Invalid date in property "${o}": "${u}"`,{file:r.file.path,property:o}),null):x(m)}let s=e.toString(),l=(a=y(s))!=null?a:new Date(s);return isNaN(l.getTime())?(console.warn(`Invalid date in property "${o}": "${s}"`,{file:r.file.path,property:o}),null):x(l)}catch(s){return console.warn(`Error parsing date from property "${o}"`,{file:r.file.path,property:o,error:String(s)}),null}}function De(r,o){let t=I(o),e=r.getValue(t);if(e===null||e instanceof f.NullValue)return{value:null,displayValue:`${o}: not set`,type:"unsupported"};if(e instanceof f.BooleanValue){let a=e.isTruthy();return{value:a?1:0,displayValue:a?"Yes":"No",type:"boolean"}}if(e instanceof f.NumberValue){let a=Number(e.toString());return isNaN(a)?{value:null,displayValue:e.toString(),type:"unsupported"}:{value:a,displayValue:String(a),type:"number"}}if(e instanceof f.StringValue){let a=e.toString(),s=parseFloat(a);if(!isNaN(s))return{value:s,displayValue:a,type:"number"};let l=a.toLowerCase();return l==="true"||l==="yes"?{value:1,displayValue:"Yes",type:"boolean"}:l==="false"||l==="no"?{value:0,displayValue:"No",type:"boolean"}:{value:null,displayValue:a,type:"unsupported"}}return{value:e.isTruthy()?1:0,displayValue:e.toString(),type:"boolean"}}function G(r,o,t){let e=new Map,n=1/0,a=-1/0,s=0,l=!1,u=0;for(let m of r){let i=q(m,o);if(!i){u++;continue}let{value:p,displayValue:c,type:d}=De(m,t);d==="number"&&p!==null&&p!==0&&p!==1&&(l=!0),p!==null&&(n=Math.min(n,p),a=Math.max(a,p),s++);let h=e.get(i);h?p!==null&&(h.value===null||p>h.value)&&e.set(i,{date:i,value:p,note:m.file,displayValue:c}):e.set(i,{date:i,value:p,note:m.file,displayValue:c})}return n===1/0&&(n=0),a===-1/0&&(a=1),n===a&&n>0&&(n=0),u>0&&console.warn(`Data processing summary: ${u} entries skipped due to invalid dates.`,{totalEntries:r.length,skippedEntries:u,successfulEntries:e.size,dateProperty:o}),{entries:e,stats:{min:n,max:a,count:s,hasNumeric:l}}}function Q(r,o,t){let e=!1,n=!1,a=!1,s=I(o);for(let l of r){if(!q(l,t))continue;let m=l.getValue(s);if(!(m===null||m instanceof f.NullValue))if(a=!0,m instanceof f.BooleanValue)e=!0;else if(m instanceof f.NumberValue){let i=Number(m.toString());if(isNaN(i))return"unsupported";i!==0&&i!==1?n=!0:e=!0}else if(m instanceof f.StringValue){let i=m.toString(),p=parseFloat(i);if(!isNaN(p))p!==0&&p!==1?n=!0:e=!0;else{let c=i.toLowerCase();if(["true","false","yes","no"].includes(c))e=!0;else return"unsupported"}}else e=!0}return a?n?"number":e?"boolean":"unsupported":"unsupported"}function P(r){let o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:{r:0,g:0,b:0}}function Ce(r,o,t){let e=n=>Math.max(0,Math.min(255,Math.round(n))).toString(16).padStart(2,"0");return`#${e(r)}${e(o)}${e(t)}`}function z(r){return/^#?[0-9a-f]{6}$/i.test(r)}function j(r){return r.startsWith("#")?r:`#${r}`}function V(r){return r<=.0031308?r*12.92:1.055*Math.pow(r,1/2.4)-.055}function S(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function J(r,o,t){let e=S(r/255),n=S(o/255),a=S(t/255),s=.4122214708*e+.5363325363*n+.0514459929*a,l=.2119034982*e+.6806995451*n+.1073969566*a,u=.0883024619*e+.2817188376*n+.6299787005*a,m=Math.cbrt(s),i=Math.cbrt(l),p=Math.cbrt(u);return{L:.2104542553*m+.793617785*i-.0040720468*p,a:1.9779984951*m-2.428592205*i+.4505937099*p,b:.0259040371*m+.7827717662*i-.808675766*p}}function we(r,o,t){let e=r+.3963377774*o+.2158037573*t,n=r-.1055613458*o-.0638541728*t,a=r-.0894841775*o-1.291485548*t,s=e*e*e,l=n*n*n,u=a*a*a,m=4.0767416621*s-3.3077115913*l+.2309699292*u,i=-1.2684380046*s+2.6097574011*l-.3413193965*u,p=-.0041960863*s-.7034186147*l+1.707614701*u;return{r:Math.round(V(m)*255),g:Math.round(V(i)*255),b:Math.round(V(p)*255)}}function $(r,o,t){let e=P(r),n=P(o),a=J(e.r,e.g,e.b),s=J(n.r,n.g,n.b),l=a.L+(s.L-a.L)*t,u=a.a+(s.a-a.a)*t,m=a.b+(s.b-a.b)*t,i=we(l,u,m);return Ce(i.r,i.g,i.b)}function xe(r){let o=P(r),t=S(o.r/255),e=S(o.g/255),n=S(o.b/255);return .2126*t+.7152*e+.0722*n}function K(r,o){let t=xe(r);if(o){if(t>.15)return $(r,"#161b22",.7)}else if(t<.85)return $(r,"#ebedf0",.7);return r}function Ee(r,o){let t=j(r),e=j(o);return{dark:{zero:K(t,!0),max:e},light:{zero:K(t,!1),max:e}}}function Z(r){return Ee(r.zeroColor,r.maxColor)}function X(r,o,t){return t===o?1:r<=o?0:r>=t?1:(r-o)/(t-o)}function ee(r){return r?1:0}function te(r,o,t){let e=t?o.dark:o.light;if(r<=0)return e.zero;let n=Math.max(0,Math.min(1,r));return $(e.zero,e.max,n)}function A(){return document.body.classList.contains("theme-dark")}function ve(r,o,t){let e=o.get(r);if(!e)return{type:"empty"};if(e.value===null)return{type:"zero",note:e.note};let n;return t.hasNumeric?n=X(e.value,t.min,t.max):n=ee(e.value>0),{type:"filled",note:e.note,intensity:n}}function Ne(r,o,t,e,n,a){let s=document.createElement("div");s.className="heatmap-cell",s.dataset.date=r,s.style.gridRow=String(t),s.style.gridColumn=String(e);let l=A();return o.type==="empty"?s.classList.add("heatmap-cell--empty"):o.type==="zero"?(s.classList.add("heatmap-cell--zero"),s.dataset.notePath=o.note.path):o.type==="filled"&&(s.classList.add("heatmap-cell--filled"),s.dataset.notePath=o.note.path,s.dataset.intensity=String(o.intensity),s.style.backgroundColor=te(o.intensity,a,l)),n&&(s.dataset.displayValue=n.displayValue),s}function Te(r,o){let t=document.createElement("div");t.className="heatmap-month-labels",t.style.setProperty("--total-weeks",String(o));for(let e of r){let n=document.createElement("span");n.className="heatmap-month-label",n.textContent=e.name,n.style.gridColumnStart=String(e.startColumn),n.style.gridColumnEnd=String(e.endColumn),t.appendChild(n)}return t}function ke(r){let o=document.createElement("div");o.className="heatmap-weekday-labels";let t=U(r),e=r===1?[0,2,4]:[1,3,5];for(let n=0;n<7;n++){let a=document.createElement("span");a.className="heatmap-weekday-label",e.includes(n)&&(a.textContent=t[n]),o.appendChild(a)}return o}function E(r,o){let t=document.createElement("div");t.className="heatmap-empty-state";let e=document.createElement("div");e.className="heatmap-empty-state-icon",e.textContent="\u26A0",t.appendChild(e);let n=document.createElement("div");n.className="heatmap-empty-state-title",n.textContent=r,t.appendChild(n);let a=document.createElement("div");return a.className="heatmap-empty-state-description",a.textContent=o,t.appendChild(a),t}function ne(r,o,t){var B;let{entries:e,stats:n}=r,{schemeDefinition:a,weekStart:s,showWeekdayLabels:l,showMonthLabels:u}=t,m=R(o.start,o.end),i=Y(o.start,o.end,s),p=w(o.end,o.start,s),c=document.createElement("div");c.className="heatmap-container",A()?c.classList.add("heatmap--dark"):c.classList.add("heatmap--light");let d=document.createElement("div");d.className="heatmap-scroll-wrapper";let h=document.createElement("div");h.className="heatmap-inner-wrapper",l&&h.classList.add("heatmap-inner-wrapper--with-labels"),u&&h.appendChild(Te(i,p));let b=document.createElement("div");b.className="heatmap-grid",l&&b.appendChild(ke(s));let D=document.createElement("div");D.className="heatmap-cells";for(let C of m){let M=(B=y(C))!=null?B:new Date(C);if(isNaN(M.getTime()))continue;let ie=H(M,s),le=w(M,o.start,s),ce=ve(C,e,n),ue=e.get(C),me=Ne(C,ce,ie+1,le,ue,a);D.appendChild(me)}return b.appendChild(D),h.appendChild(b),d.appendChild(h),c.appendChild(d),c}var re=require("obsidian");function oe(r){let{app:o,entries:t,containerEl:e,plugin:n}=r,a=[],s=i=>{let c=i.target.closest(".heatmap-cell");if(!(c instanceof HTMLElement))return;let d=c.dataset.notePath;d&&o.workspace.openLinkText(d,"",!1)};e.addEventListener("click",s),a.push(()=>e.removeEventListener("click",s));let l=i=>{let c=i.target.closest(".heatmap-cell");if(!(c instanceof HTMLElement))return;let d=c.dataset.date;if(!d)return;let h=c.dataset.notePath;h&&(i.ctrlKey||i.metaKey)&&o.workspace.trigger("hover-link",{event:i,source:"heatmap-bases-view",hoverParent:e,targetEl:c,linktext:h,sourcePath:""});let b=Me(d,t.get(d),c,n);(0,re.setTooltip)(c,b,{placement:"top"})};e.addEventListener("mouseover",l),a.push(()=>e.removeEventListener("mouseover",l));let u=i=>{let c=i.target.closest(".heatmap-cell");if(!(!(c instanceof HTMLElement)||!c.dataset.date)){if(i.key==="Enter"){let h=c.dataset.notePath;h&&o.workspace.openLinkText(h,"",!1)}["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(i.key)&&(i.preventDefault(),He(c,i.key,e))}};return e.addEventListener("keydown",u),a.push(()=>e.removeEventListener("keydown",u)),e.querySelectorAll(".heatmap-cell").forEach(i=>{i.tabIndex=0}),()=>{a.forEach(i=>i())}}function Me(r,o,t,e){let n=W(r);if(!o)return`${n}
No note`;let a=t.dataset.displayValue||o.displayValue,s=t.style.backgroundColor?Le(t.style.backgroundColor):"",l=e.settings.showHexColorInTooltip&&s?`
${s}`:"";return`${n}
${a}${l}`}function Le(r){if(r.startsWith("#"))return r;let o=r.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(!o)return r;let t=parseInt(o[1],10),e=parseInt(o[2],10),n=parseInt(o[3],10),a=s=>s.toString(16).padStart(2,"0");return`#${a(t)}${a(e)}${a(n)}`}function He(r,o,t){var u;let e=r.dataset.date;if(!e)return;let n=(u=y(e))!=null?u:new Date(e);if(isNaN(n.getTime()))return;let a;switch(o){case"ArrowUp":a=new Date(n),a.setDate(n.getDate()-1);break;case"ArrowDown":a=new Date(n),a.setDate(n.getDate()+1);break;case"ArrowLeft":a=new Date(n),a.setDate(n.getDate()-7);break;case"ArrowRight":a=new Date(n),a.setDate(n.getDate()+7);break;default:return}let s=Ie(a),l=t.querySelector(`.heatmap-cell[data-date="${s}"]`);l instanceof HTMLElement&&l.focus()}function Ie(r){let o=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),e=String(r.getDate()).padStart(2,"0");return`${o}-${t}-${e}`}var v=class extends ae.BasesView{constructor(t,e,n){super(t);this.plugin=n;this.type="heatmap";this.cleanupInteractions=null;this.processedData=null;this.containerEl=e.createDiv("heatmap-view-container")}getConfig(){let t=this.config,e=t.get("minValue"),n=t.get("maxValue"),a=e?parseFloat(e):null,s=n?parseFloat(n):null;return{dateProperty:t.get("dateProperty")||"__filename__",valueProperty:t.get("valueProperty")||"",startDate:t.get("startDate")||null,endDate:t.get("endDate")||null,colorScheme:t.get("colorScheme")||"green",weekStart:parseInt(t.get("weekStart")||"0",10),showWeekdayLabels:t.get("showWeekdayLabels")!==!1,showMonthLabels:t.get("showMonthLabels")!==!1,minValue:a!==null&&!isNaN(a)?a:null,maxValue:s!==null&&!isNaN(s)?s:null}}onDataUpdated(){this.render()}render(){var p;this.cleanupInteractions&&(this.cleanupInteractions(),this.cleanupInteractions=null),this.containerEl.empty();let t=this.getConfig();if(!t.valueProperty){let c=E("Configure value property","Select a property to visualize in the view settings.");this.containerEl.appendChild(c);return}let e=this.data;if(!e)return;let n=e.data||[];if(n.length===0){let c=E("No data to display","No notes found in the current filter. Check your Base filters.");this.containerEl.appendChild(c);return}if(Q(n,t.valueProperty,t.dateProperty)==="unsupported"){let c=E("Unsupported property type",`"${t.valueProperty}" is not a boolean or number property. Heatmap requires boolean or number properties.`);this.containerEl.appendChild(c);return}if(this.processedData=G(n,t.dateProperty,t.valueProperty),t.minValue!==null&&(this.processedData.stats.min=t.minValue),t.maxValue!==null&&(this.processedData.stats.max=t.maxValue),this.processedData.entries.size===0){let c=E("No dated notes found","No notes with valid dates were found. Check your date property setting.");this.containerEl.appendChild(c);return}let s=_(this.processedData.entries,t.startDate,t.endDate),l=(p=this.plugin.settings.colorSchemes.find(c=>c.id===t.colorScheme))!=null?p:this.plugin.settings.colorSchemes[0],m={schemeDefinition:Z(l),weekStart:t.weekStart,showWeekdayLabels:t.showWeekdayLabels,showMonthLabels:t.showMonthLabels},i=ne(this.processedData,s,m);this.containerEl.appendChild(i),this.cleanupInteractions=oe({app:this.app,entries:this.processedData.entries,containerEl:i,plugin:this.plugin})}};var N=[{id:"green",name:"Green",zeroColor:"#ebedf0",maxColor:"#39d353",isDefault:!0},{id:"purple",name:"Purple",zeroColor:"#ebedf0",maxColor:"#a78bfa",isDefault:!0},{id:"blue",name:"Blue",zeroColor:"#ebedf0",maxColor:"#38bdf8",isDefault:!0},{id:"orange",name:"Orange",zeroColor:"#ebedf0",maxColor:"#fb923c",isDefault:!0},{id:"gray",name:"Gray",zeroColor:"#ebedf0",maxColor:"#adbac7",isDefault:!0}],se={showHexColorInTooltip:!1,colorSchemes:N};var T=class extends g.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new O(this.app,this)),this.app.workspace.registerHoverLinkSource("heatmap-bases-view",{display:"Heatmap",defaultMod:!0}),this.registerBasesView("heatmap",{name:"Heatmap",icon:"calendar-heat",factory:(t,e)=>new v(t,e,this),options:()=>[{type:"property",key:"dateProperty",displayName:"Date property",placeholder:"Use filename for daily notes"},{type:"property",key:"valueProperty",displayName:"Value property"},{type:"text",key:"startDate",displayName:"Start date",placeholder:"YYYY-MM-DD (leave empty for auto)"},{type:"text",key:"endDate",displayName:"End date",placeholder:"YYYY-MM-DD (leave empty for today)"},{type:"dropdown",key:"colorScheme",displayName:"Color scheme",default:"green",options:this.getColorSchemeOptions()},{type:"dropdown",key:"weekStart",displayName:"Week starts on",default:"0",options:{0:"Sunday",1:"Monday"}},{type:"toggle",key:"showWeekdayLabels",displayName:"Show weekday labels",default:!0},{type:"toggle",key:"showMonthLabels",displayName:"Show month labels",default:!0},{type:"text",key:"minValue",displayName:"Min value",placeholder:"Auto (based on data)"},{type:"text",key:"maxValue",displayName:"Max value",placeholder:"Auto (based on data)"}]})}onunload(){}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},se,t),(!this.settings.colorSchemes||this.settings.colorSchemes.length===0)&&(this.settings.colorSchemes=N)}async saveSettings(){await this.saveData(this.settings)}getColorSchemeOptions(){let t={};for(let e of this.settings.colorSchemes)t[e.id]=e.name;return t}},O=class extends g.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),new g.Setting(t).setName("Show hex color in tooltip").setDesc("Display the hex color code in cell tooltips on hover").addToggle(e=>e.setValue(this.plugin.settings.showHexColorInTooltip).onChange(async n=>{this.plugin.settings.showHexColorInTooltip=n,await this.plugin.saveSettings()})),new g.Setting(t).setName("Color schemes").setHeading(),new g.Setting(t).setDesc("Add, edit, or remove color schemes used in heatmaps. Changes are available in the view settings.").addButton(e=>e.setButtonText("Add color scheme").setCta().onClick(()=>this.addScheme()));for(let e of this.plugin.settings.colorSchemes)this.renderSchemeRow(t,e)}renderSchemeRow(t,e){let n=new g.Setting(t).setName(e.name).setDesc(`${e.zeroColor} \u2192 ${e.maxColor}`).addButton(s=>s.setIcon("pencil").setTooltip("Edit").onClick(()=>this.editScheme(e))).addButton(s=>s.setIcon("trash").setTooltip("Delete").onClick(()=>this.deleteScheme(e))),a=n.controlEl.createDiv("heatmap-color-scheme-preview");a.style.width="60px",a.style.height="20px",a.style.borderRadius="4px",a.style.marginRight="8px",a.style.background=`linear-gradient(to right, ${e.zeroColor}, ${e.maxColor})`,n.controlEl.insertBefore(a,n.controlEl.firstChild)}addScheme(){let t={id:"",name:"",zeroColor:"#ebedf0",maxColor:"#39d353"};new k(this.app,t,!0,e=>{this.plugin.settings.colorSchemes.push(e),this.plugin.saveSettings().then(()=>this.display())}).open()}editScheme(t){new k(this.app,t,!1,e=>{let n=this.plugin.settings.colorSchemes.findIndex(a=>a.id===t.id);n!==-1&&(this.plugin.settings.colorSchemes[n]=e,this.plugin.saveSettings().then(()=>this.display()))}).open()}async deleteScheme(t){let e=this.plugin.settings.colorSchemes.findIndex(n=>n.id===t.id);e!==-1&&(this.plugin.settings.colorSchemes.splice(e,1),this.plugin.settings.colorSchemes.length===0&&(this.plugin.settings.colorSchemes=[...N]),await this.plugin.saveSettings(),this.display())}},k=class extends g.Modal{constructor(t,e,n,a){super(t);this.errorEl=null;this.scheme={...e},this.isNew=n,this.onSave=a}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?"Add color scheme":"Edit color scheme"}),new g.Setting(t).setName("Name").setDesc("Display name for this color scheme").addText(e=>e.setPlaceholder("My Custom Scheme").setValue(this.scheme.name).onChange(n=>this.scheme.name=n)),new g.Setting(t).setName("Zero color").setDesc("Color for empty/zero values (hex format, e.g. #ebedf0)").addText(e=>e.setPlaceholder("#ebedf0").setValue(this.scheme.zeroColor).onChange(n=>this.scheme.zeroColor=n)),new g.Setting(t).setName("Max color").setDesc("Color for maximum values (hex format, e.g. #39d353)").addText(e=>e.setPlaceholder("#39d353").setValue(this.scheme.maxColor).onChange(n=>this.scheme.maxColor=n)),this.errorEl=t.createDiv("heatmap-modal-error"),this.errorEl.style.color="var(--text-error)",this.errorEl.style.marginBottom="1em",new g.Setting(t).addButton(e=>e.setButtonText("Save").setCta().onClick(()=>this.save())).addButton(e=>e.setButtonText("Cancel").onClick(()=>this.close()))}save(){if(!this.scheme.name.trim()){this.showError("Name is required");return}if(!z(this.scheme.zeroColor)){this.showError("Zero color must be a valid hex color (e.g. #ebedf0)");return}if(!z(this.scheme.maxColor)){this.showError("Max color must be a valid hex color (e.g. #39d353)");return}this.scheme.zeroColor.startsWith("#")||(this.scheme.zeroColor="#"+this.scheme.zeroColor),this.scheme.maxColor.startsWith("#")||(this.scheme.maxColor="#"+this.scheme.maxColor),this.isNew&&(this.scheme.id=this.scheme.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""),this.scheme.id||(this.scheme.id="scheme")),this.onSave(this.scheme),this.close()}showError(t){this.errorEl&&(this.errorEl.textContent=t)}onClose(){this.contentEl.empty()}};
