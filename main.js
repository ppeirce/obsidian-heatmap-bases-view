/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var M=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var se=Object.prototype.hasOwnProperty;var le=(r,a)=>{for(var t in a)M(r,t,{get:a[t],enumerable:!0})},ie=(r,a,t,e)=>{if(a&&typeof a=="object"||typeof a=="function")for(let n of oe(a))!se.call(r,n)&&n!==t&&M(r,n,{get:()=>a[n],enumerable:!(e=re(a,n))||e.enumerable});return r};var ce=r=>ie(M({},"__esModule",{value:!0}),r);var ke={};le(ke,{default:()=>k});module.exports=ce(ke);var X=require("obsidian");var K=require("obsidian");var f=require("obsidian");var ue=/^(\d{4})-(\d{2})-(\d{2})$/;function g(r){let a=ue.exec(r.trim());if(!a)return null;let t=Number(a[1]),e=Number(a[2])-1,n=Number(a[3]);if(isNaN(t)||isNaN(e)||isNaN(n))return null;let o=new Date(t,e,n);return o.setHours(0,0,0,0),o}var pe=[/^(\d{4}-\d{2}-\d{2})/,/^(\d{4})\/(\d{2})\/(\d{2})/,/^(\w+ \d{1,2}, \d{4})/];function I(r){let a=r.replace(/\.md$/i,"");for(let t of pe){let e=a.match(t);if(e){let n;e.length===4?n=`${e[1]}-${e[2]}-${e[3]}`:n=e[1];let o=g(n);if(o)return o;let s=new Date(n);if(!isNaN(s.getTime()))return s.setHours(0,0,0,0),s}}return null}function S(r){let a=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),e=String(r.getDate()).padStart(2,"0");return`${a}-${t}-${e}`}function P(r){var t;let a=(t=g(r))!=null?t:new Date(r);return isNaN(a.getTime())?r:a.toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"short",day:"numeric"})}function $(r,a){let t=[],e=new Date(r);e.setHours(0,0,0,0);let n=new Date(a);for(n.setHours(0,0,0,0);e<=n;)t.push(S(e)),e.setDate(e.getDate()+1);return t}function C(r,a){let t=r.getDay();return a===0?t:t===0?6:t-1}function w(r,a,t){let e=new Date(r);e.setHours(0,0,0,0);let n=new Date(a);n.setHours(0,0,0,0);let o=e.getTime()-n.getTime(),s=Math.floor(o/(1e3*60*60*24)),i=C(n,t);return Math.floor((s+i)/7)+1}function O(r,a,t){var o,s;let e,n;if(t?(n=(o=g(t))!=null?o:new Date(t),isNaN(n.getTime())&&(n=new Date)):n=new Date,n.setHours(0,0,0,0),a)e=(s=g(a))!=null?s:new Date(a),isNaN(e.getTime())&&(e=new Date(n.getFullYear(),0,1));else{let i=Array.from(r.keys()).map(c=>{var l;return(l=g(c))!=null?l:new Date(c)}).filter(c=>!isNaN(c.getTime())).sort((c,l)=>c.getTime()-l.getTime());i.length>0?e=i[0]:e=new Date(n.getFullYear(),0,1)}return e.setHours(0,0,0,0),{start:e,end:n}}function W(r,a,t){let e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=new Map,o=new Date(r);o.setHours(0,0,0,0);let s=new Date(a);for(s.setHours(0,0,0,0);o<=s;){let p=o.getMonth(),m=w(o,r,t),d=n.get(m);d||(d=new Set,n.set(m,d)),d.add(p),o.setDate(o.getDate()+1)}let i=[],c=w(s,r,t),l=-1,u=null;for(let p=1;p<=c;p++){let m=n.get(p);if(!m)continue;let d=Array.from(m).sort((y,b)=>y-b),h=d[d.length-1];h!==l&&(u&&(u.endColumn=p),u={name:e[h],startColumn:p,endColumn:c+1},i.push(u),l=h)}return u&&(u.endColumn=c+1),i}function A(r){let a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return r===1?["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]:a}function L(r){return r.includes(".")?r:`frontmatter.${r}`}function z(r,a){var s,i;if(a==="__filename__"||!a){let c=I(r.file.basename);return c?S(c):null}let t=L(a),e=r.getValue(t);if(e===null||e instanceof f.NullValue)return null;if(e instanceof f.DateValue){let c=e.toString(),l=(s=g(c))!=null?s:new Date(c);return isNaN(l.getTime())?null:S(l)}let n=e.toString(),o=(i=g(n))!=null?i:new Date(n);return isNaN(o.getTime())?null:S(o)}function me(r,a){let t=L(a),e=r.getValue(t);if(e===null||e instanceof f.NullValue)return{value:null,displayValue:`${a}: not set`,type:"unsupported"};if(e instanceof f.BooleanValue){let o=e.isTruthy();return{value:o?1:0,displayValue:o?"Yes":"No",type:"boolean"}}if(e instanceof f.NumberValue){let o=Number(e.toString());return isNaN(o)?{value:null,displayValue:e.toString(),type:"unsupported"}:{value:o,displayValue:String(o),type:"number"}}if(e instanceof f.StringValue){let o=e.toString(),s=parseFloat(o);if(!isNaN(s))return{value:s,displayValue:o,type:"number"};let i=o.toLowerCase();return i==="true"||i==="yes"?{value:1,displayValue:"Yes",type:"boolean"}:i==="false"||i==="no"?{value:0,displayValue:"No",type:"boolean"}:{value:null,displayValue:o,type:"unsupported"}}return{value:e.isTruthy()?1:0,displayValue:e.toString(),type:"boolean"}}function B(r,a,t){let e=new Map,n=1/0,o=-1/0,s=0,i=!1;for(let c of r){let l=z(c,a);if(!l)continue;let{value:u,displayValue:p,type:m}=me(c,t);m==="number"&&u!==null&&u!==0&&u!==1&&(i=!0),u!==null&&(n=Math.min(n,u),o=Math.max(o,u),s++);let d=e.get(l);d?u!==null&&(d.value===null||u>d.value)&&e.set(l,{date:l,value:u,note:c.file,displayValue:p}):e.set(l,{date:l,value:u,note:c.file,displayValue:p})}return n===1/0&&(n=0),o===-1/0&&(o=1),n===o&&n>0&&(n=0),{entries:e,stats:{min:n,max:o,count:s,hasNumeric:i}}}function F(r,a,t){let e=!1,n=!1,o=!1,s=L(a);for(let i of r){if(!z(i,t))continue;let l=i.getValue(s);if(!(l===null||l instanceof f.NullValue))if(o=!0,l instanceof f.BooleanValue)e=!0;else if(l instanceof f.NumberValue){let u=Number(l.toString());if(isNaN(u))return"unsupported";u!==0&&u!==1?n=!0:e=!0}else if(l instanceof f.StringValue){let u=l.toString(),p=parseFloat(u);if(!isNaN(p))p!==0&&p!==1?n=!0:e=!0;else{let m=u.toLowerCase();if(["true","false","yes","no"].includes(m))e=!0;else return"unsupported"}}else e=!0}return o?n?"number":e?"boolean":"unsupported":"unsupported"}var _={green:{dark:{zero:"#161b22",max:"#39d353"},light:{zero:"#ebedf0",max:"#216e39"}},purple:{dark:{zero:"#1a1523",max:"#a78bfa"},light:{zero:"#ebedf0",max:"#5b21b6"}},blue:{dark:{zero:"#161b22",max:"#38bdf8"},light:{zero:"#ebedf0",max:"#0284c7"}},orange:{dark:{zero:"#1c1917",max:"#fb923c"},light:{zero:"#ebedf0",max:"#ea580c"}},gray:{dark:{zero:"#161b22",max:"#adbac7"},light:{zero:"#ebedf0",max:"#444c56"}}};function R(r){let a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:{r:0,g:0,b:0}}function de(r,a,t){let e=n=>Math.max(0,Math.min(255,Math.round(n))).toString(16).padStart(2,"0");return`#${e(r)}${e(a)}${e(t)}`}function T(r){return r<=.0031308?r*12.92:1.055*Math.pow(r,1/2.4)-.055}function v(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Y(r,a,t){let e=v(r/255),n=v(a/255),o=v(t/255),s=.4122214708*e+.5363325363*n+.0514459929*o,i=.2119034982*e+.6806995451*n+.1073969566*o,c=.0883024619*e+.2817188376*n+.6299787005*o,l=Math.cbrt(s),u=Math.cbrt(i),p=Math.cbrt(c);return{L:.2104542553*l+.793617785*u-.0040720468*p,a:1.9779984951*l-2.428592205*u+.4505937099*p,b:.0259040371*l+.7827717662*u-.808675766*p}}function fe(r,a,t){let e=r+.3963377774*a+.2158037573*t,n=r-.1055613458*a-.0638541728*t,o=r-.0894841775*a-1.291485548*t,s=e*e*e,i=n*n*n,c=o*o*o,l=4.0767416621*s-3.3077115913*i+.2309699292*c,u=-1.2684380046*s+2.6097574011*i-.3413193965*c,p=-.0041960863*s-.7034186147*i+1.707614701*c;return{r:Math.round(T(l)*255),g:Math.round(T(u)*255),b:Math.round(T(p)*255)}}function ge(r,a,t){let e=R(r),n=R(a),o=Y(e.r,e.g,e.b),s=Y(n.r,n.g,n.b),i=o.L+(s.L-o.L)*t,c=o.a+(s.a-o.a)*t,l=o.b+(s.b-o.b)*t,u=fe(i,c,l);return de(u.r,u.g,u.b)}function U(r,a,t){return t===a?1:r<=a?0:r>=t?1:(r-a)/(t-a)}function q(r){return r?1:0}function Q(r,a,t){let e=t?_[a].dark:_[a].light;if(r<=0)return e.zero;let n=Math.max(0,Math.min(1,r));return ge(e.zero,e.max,n)}function V(){return document.body.classList.contains("theme-dark")}function he(r,a,t){let e=a.get(r);if(!e)return{type:"empty"};if(e.value===null)return{type:"zero",note:e.note};let n;return t.hasNumeric?n=U(e.value,t.min,t.max):n=q(e.value>0),{type:"filled",note:e.note,intensity:n}}function ye(r,a,t,e,n,o){let s=document.createElement("div");s.className="heatmap-cell",s.dataset.date=r,s.style.gridRow=String(t),s.style.gridColumn=String(e);let i=V();return a.type==="empty"?s.classList.add("heatmap-cell--empty"):a.type==="zero"?(s.classList.add("heatmap-cell--zero"),s.dataset.notePath=a.note.path):a.type==="filled"&&(s.classList.add("heatmap-cell--filled"),s.dataset.notePath=a.note.path,s.dataset.intensity=String(a.intensity),s.style.backgroundColor=Q(a.intensity,o,i)),n&&(s.dataset.displayValue=n.displayValue),s}function be(r,a){let t=document.createElement("div");t.className="heatmap-month-labels",t.style.setProperty("--total-weeks",String(a));for(let e of r){let n=document.createElement("span");n.className="heatmap-month-label",n.textContent=e.name,n.style.gridColumnStart=String(e.startColumn),n.style.gridColumnEnd=String(e.endColumn),t.appendChild(n)}return t}function De(r){let a=document.createElement("div");a.className="heatmap-weekday-labels";let t=A(r),e=r===1?[0,2,4]:[1,3,5];for(let n=0;n<7;n++){let o=document.createElement("span");o.className="heatmap-weekday-label",e.includes(n)&&(o.textContent=t[n]),a.appendChild(o)}return a}function N(r,a){let t=document.createElement("div");t.className="heatmap-empty-state";let e=document.createElement("div");e.className="heatmap-empty-state-icon",e.textContent="\u26A0",t.appendChild(e);let n=document.createElement("div");n.className="heatmap-empty-state-title",n.textContent=r,t.appendChild(n);let o=document.createElement("div");return o.className="heatmap-empty-state-description",o.textContent=a,t.appendChild(o),t}function G(r,a,t){var H;let{entries:e,stats:n}=r,{colorScheme:o,weekStart:s,showWeekdayLabels:i,showMonthLabels:c}=t,l=$(a.start,a.end),u=W(a.start,a.end,s),p=w(a.end,a.start,s),m=document.createElement("div");m.className=`heatmap-container heatmap--${o}`,V()?m.classList.add("heatmap--dark"):m.classList.add("heatmap--light");let d=document.createElement("div");d.className="heatmap-scroll-wrapper";let h=document.createElement("div");h.className="heatmap-inner-wrapper",i&&h.classList.add("heatmap-inner-wrapper--with-labels"),c&&h.appendChild(be(u,p));let y=document.createElement("div");y.className="heatmap-grid",i&&y.appendChild(De(s));let b=document.createElement("div");b.className="heatmap-cells";for(let D of l){let x=(H=g(D))!=null?H:new Date(D);if(isNaN(x.getTime()))continue;let Z=C(x,s),ee=w(x,a.start,s),te=he(D,e,n),ne=e.get(D),ae=ye(D,te,Z+1,ee,ne,o);b.appendChild(ae)}return y.appendChild(b),h.appendChild(y),d.appendChild(h),m.appendChild(d),m}var J=require("obsidian");function j(r){let{app:a,entries:t,containerEl:e}=r,n=[],o=l=>{let p=l.target.closest(".heatmap-cell");if(!p)return;let m=p.dataset.notePath;m&&a.workspace.openLinkText(m,"",!1)};e.addEventListener("click",o),n.push(()=>e.removeEventListener("click",o));let s=l=>{let p=l.target.closest(".heatmap-cell");if(!p)return;let m=p.dataset.date;if(!m)return;let d=we(m,t.get(m),p);(0,J.setTooltip)(p,d,{placement:"top"})};e.addEventListener("mouseover",s),n.push(()=>e.removeEventListener("mouseover",s));let i=l=>{let p=l.target.closest(".heatmap-cell");if(!(!p||!p.dataset.date)){if(l.key==="Enter"){let d=p.dataset.notePath;d&&a.workspace.openLinkText(d,"",!1)}["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(l.key)&&(l.preventDefault(),Ne(p,l.key,e))}};return e.addEventListener("keydown",i),n.push(()=>e.removeEventListener("keydown",i)),e.querySelectorAll(".heatmap-cell").forEach(l=>{l.tabIndex=0}),()=>{n.forEach(l=>l())}}function we(r,a,t){let e=P(r);if(!a)return`${e}
No note`;let n=t.dataset.displayValue||a.displayValue,o=t.style.backgroundColor?Se(t.style.backgroundColor):"",s=o?`
${o}`:"";return`${e}
${n}${s}`}function Se(r){if(r.startsWith("#"))return r;let a=r.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(!a)return r;let t=parseInt(a[1],10),e=parseInt(a[2],10),n=parseInt(a[3],10),o=s=>s.toString(16).padStart(2,"0");return`#${o(t)}${o(e)}${o(n)}`}function Ne(r,a,t){var c;let e=r.dataset.date;if(!e)return;let n=(c=g(e))!=null?c:new Date(e);if(isNaN(n.getTime()))return;let o;switch(a){case"ArrowUp":o=new Date(n),o.setDate(n.getDate()-1);break;case"ArrowDown":o=new Date(n),o.setDate(n.getDate()+1);break;case"ArrowLeft":o=new Date(n),o.setDate(n.getDate()-7);break;case"ArrowRight":o=new Date(n),o.setDate(n.getDate()+7);break;default:return}let s=Ee(o),i=t.querySelector(`.heatmap-cell[data-date="${s}"]`);i&&i.focus()}function Ee(r){let a=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),e=String(r.getDate()).padStart(2,"0");return`${a}-${t}-${e}`}var E=class extends K.BasesView{constructor(t,e){super(t);this.type="heatmap";this.cleanupInteractions=null;this.processedData=null;this.containerEl=e.createDiv("heatmap-view-container")}getConfig(){let t=this.config,e=t.get("minValue"),n=t.get("maxValue"),o=e?parseFloat(e):null,s=n?parseFloat(n):null;return{dateProperty:t.get("dateProperty")||"__filename__",valueProperty:t.get("valueProperty")||"",startDate:t.get("startDate")||null,endDate:t.get("endDate")||null,colorScheme:t.get("colorScheme")||"green",weekStart:parseInt(t.get("weekStart")||"0",10),showWeekdayLabels:t.get("showWeekdayLabels")!==!1,showMonthLabels:t.get("showMonthLabels")!==!1,minValue:o!==null&&!isNaN(o)?o:null,maxValue:s!==null&&!isNaN(s)?s:null}}onDataUpdated(){this.render()}render(){this.cleanupInteractions&&(this.cleanupInteractions(),this.cleanupInteractions=null),this.containerEl.empty();let t=this.getConfig();if(!t.valueProperty){let l=N("Configure value property","Select a property to visualize in the view settings.");this.containerEl.appendChild(l);return}let e=this.data;if(!e)return;let n=e.data||[];if(n.length===0){let l=N("No data to display","No notes found in the current filter. Check your Base filters.");this.containerEl.appendChild(l);return}if(F(n,t.valueProperty,t.dateProperty)==="unsupported"){let l=N("Unsupported property type",`"${t.valueProperty}" is not a boolean or number property. Heatmap requires boolean or number properties.`);this.containerEl.appendChild(l);return}if(this.processedData=B(n,t.dateProperty,t.valueProperty),t.minValue!==null&&(this.processedData.stats.min=t.minValue),t.maxValue!==null&&(this.processedData.stats.max=t.maxValue),this.processedData.entries.size===0){let l=N("No dated notes found","No notes with valid dates were found. Check your date property setting.");this.containerEl.appendChild(l);return}let s=O(this.processedData.entries,t.startDate,t.endDate),i={colorScheme:t.colorScheme,weekStart:t.weekStart,showWeekdayLabels:t.showWeekdayLabels,showMonthLabels:t.showMonthLabels},c=G(this.processedData,s,i);this.containerEl.appendChild(c),this.cleanupInteractions=j({app:this.app,entries:this.processedData.entries,containerEl:c})}};var k=class extends X.Plugin{async onload(){this.registerBasesView("heatmap",{name:"Heatmap",icon:"calendar-heat",factory:(a,t)=>new E(a,t),options:()=>[{type:"property",key:"dateProperty",displayName:"Date property",placeholder:"Use filename for daily notes"},{type:"property",key:"valueProperty",displayName:"Value property"},{type:"text",key:"startDate",displayName:"Start date",placeholder:"YYYY-MM-DD (leave empty for auto)"},{type:"text",key:"endDate",displayName:"End date",placeholder:"YYYY-MM-DD (leave empty for today)"},{type:"dropdown",key:"colorScheme",displayName:"Color scheme",default:"green",options:{green:"Green",purple:"Purple",blue:"Blue",orange:"Orange",gray:"Gray"}},{type:"dropdown",key:"weekStart",displayName:"Week starts on",default:"0",options:{0:"Sunday",1:"Monday"}},{type:"toggle",key:"showWeekdayLabels",displayName:"Show weekday labels",default:!0},{type:"toggle",key:"showMonthLabels",displayName:"Show month labels",default:!0},{type:"text",key:"minValue",displayName:"Min value",placeholder:"Auto (based on data)"},{type:"text",key:"maxValue",displayName:"Max value",placeholder:"Auto (based on data)"}]})}onunload(){}};
